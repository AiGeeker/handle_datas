"""
现在我们有全球排名靠前的10000本书的数据，那么请统计一下下面几个问题：
不同年份书的数量
不同年份书的平均评分情况
"""
import pandas as pd
from matplotlib import pyplot as plt
file_path = "./books.csv"
df = pd.read_csv(file_path)
# print(df.head(2))
#
# print(df.info())
data1 = df[pd.notnull(df["original_publication_year"])]
print(data1)
print("*"*20)
grouped = data1.groupby(by="original_publication_year").count()["title"]
print(grouped)
"""
original_publication_year
-1750.0      1
-762.0       1
-750.0       2
-720.0       1
-560.0       1
-500.0       3
-476.0       1
-458.0       2
-441.0       1
-440.0       1
-431.0       1
-430.0       1
-411.0       2
-401.0       1
-400.0       2
-390.0       1
-385.0       2
-380.0       1
-350.0       2
-335.0       1
-330.0       1
-300.0       1
-17.0        1
 8.0         1
 119.0       1
 180.0       1
 397.0       1
 609.0       1
 800.0       1
 975.0       1
          ... 
 1988.0     89
 1989.0     87
 1990.0     99
 1991.0     98
 1992.0    112
 1993.0    115
 1994.0    121
 1995.0    126
 1996.0    163
 1997.0    168
 1998.0    172
 1999.0    186
 2000.0    209
 2001.0    226
 2002.0    225
 2003.0    288
 2004.0    307
 2005.0    326
 2006.0    362
 2007.0    363
 2008.0    383
 2009.0    432
 2010.0    473
 2011.0    556
 2012.0    568
 2013.0    518
 2014.0    437
 2015.0    306
 2016.0    198
 2017.0     11
"""
print(type(grouped))
"""
<class 'pandas.core.series.Series'>
"""
grouped1 = data1["average_rating"].groupby(by=data1["original_publication_year"]).mean()
print(grouped1)
"""
-1750.0    3.630000
-762.0     4.030000
-750.0     4.005000
-720.0     3.730000
-560.0     4.050000
-500.0     4.146667
-476.0     3.820000
-458.0     3.905000
-441.0     3.600000
-440.0     3.970000
-431.0     3.830000
-430.0     3.670000
-411.0     3.855000
-401.0     3.960000
-400.0     4.080000
-390.0     4.150000
-385.0     4.055000
-380.0     3.900000
-350.0     3.910000
-335.0     3.810000
-330.0     4.000000
-300.0     4.310000
-17.0      3.810000
 8.0       4.030000
 119.0     4.050000
 180.0     4.200000
 397.0     3.880000
 609.0     4.340000
 800.0     4.060000
 975.0     3.420000
             ...   
 1988.0    4.047528
 1989.0    4.059080
 1990.0    4.057677
 1991.0    4.034592
 1992.0    4.029464
 1993.0    4.045217
 1994.0    4.034463
 1995.0    4.015476
 1996.0    4.047975
 1997.0    4.010893
 1998.0    4.008779
 1999.0    4.002527
 2000.0    3.996077
 2001.0    3.982389
"""
_x = grouped1.index
_y = grouped1.values
# 画图
plt.figure(figsize=(20, 8), dpi=80)
plt.plot(range(len(_x)), _y)

plt.xticks(list(range(len(_x)))[::10], _x[::10].astype(int))
plt.show()